<div class="surface-ground px-4 py-8 md:px-6 lg:px-8 flex justify-center items-center">
  <p-toast></p-toast>
  <div class="flex align-items-center justify-content-center min-h-screen">
    <div class="w-full max-w-md">
      <p-card>
        <ng-template pTemplate="header">
          <div class="text-center pt-4">
            <div class="flex align-items-center justify-content-center mb-3">
              <div class="bg-primary border-circle p-3">
                <i class="pi pi-lock text-white text-4xl"></i>
              </div>
            </div>
            <h2 class="text-900 font-bold text-2xl mb-2">Cambiar Contraseña</h2>
            <p class="text-600 text-base mb-0">Actualiza tu contraseña de acceso</p>
          </div>
        </ng-template>

        <form [formGroup]="changePasswordForm" (ngSubmit)="onSubmit()">
          <!-- Contraseña Actual -->
          <div class="field mb-4">
            <label for="oldPassword" class="block font-medium text-900 mb-2">
              <i class="pi pi-key mr-2 text-primary"></i>Contraseña Actual
            </label>
            <p-password
              id="oldPassword"
              formControlName="oldPassword"
              placeholder="Ingresa tu contraseña actual"
              [toggleMask]="true"
              [feedback]="false"
              styleClass="w-full"
              inputStyleClass="w-full"
              [class.ng-invalid]="submitted && oldPassword?.invalid"
              [class.ng-dirty]="submitted && oldPassword?.invalid">
            </p-password>
            <small 
              class="text-red-500 block mt-1" 
              *ngIf="submitted && oldPassword?.errors?.['required']">
              <i class="pi pi-exclamation-circle mr-1"></i>La contraseña actual es requerida
            </small>
            <small 
              class="text-red-500 block mt-1" 
              *ngIf="submitted && oldPassword?.errors?.['minlength']">
              <i class="pi pi-exclamation-circle mr-1"></i>La contraseña debe tener al menos 6 caracteres
            </small>
          </div>

          <!-- Nueva Contraseña -->
          <div class="field mb-4">
            <label for="newPassword" class="block font-medium text-900 mb-2">
              <i class="pi pi-lock mr-2 text-green-500"></i>Nueva Contraseña
            </label>
            <p-password
              id="newPassword"
              formControlName="newPassword"
              placeholder="Ingresa tu nueva contraseña"
              [toggleMask]="true"
              [feedback]="true"
              styleClass="w-full"
              inputStyleClass="w-full"
              [class.ng-invalid]="submitted && newPassword?.invalid"
              [class.ng-dirty]="submitted && newPassword?.invalid">
            </p-password>
            <small 
              class="text-red-500 block mt-1" 
              *ngIf="submitted && newPassword?.errors?.['required']">
              <i class="pi pi-exclamation-circle mr-1"></i>La nueva contraseña es requerida
            </small>
            <small 
              class="text-red-500 block mt-1" 
              *ngIf="submitted && newPassword?.errors?.['minlength']">
              <i class="pi pi-exclamation-circle mr-1"></i>La contraseña debe tener al menos 6 caracteres
            </small>
          </div>

          <!-- Confirmar Nueva Contraseña -->
          <div class="field mb-4">
            <label for="confirmPassword" class="block font-medium text-900 mb-2">
              <i class="pi pi-check-circle mr-2 text-blue-500"></i>Confirmar Nueva Contraseña
            </label>
            <p-password
              id="confirmPassword"
              formControlName="confirmPassword"
              placeholder="Confirma tu nueva contraseña"
              [toggleMask]="true"
              [feedback]="false"
              styleClass="w-full"
              inputStyleClass="w-full"
              [class.ng-invalid]="submitted && confirmPassword?.invalid"
              [class.ng-dirty]="submitted && confirmPassword?.invalid">
            </p-password>
            <small 
              class="text-red-500 block mt-1" 
              *ngIf="submitted && confirmPassword?.errors?.['required']">
              <i class="pi pi-exclamation-circle mr-1"></i>Debes confirmar tu nueva contraseña
            </small>
            <small 
              class="text-red-500 block mt-1" 
              *ngIf="submitted && confirmPassword?.errors?.['passwordMismatch']">
              <i class="pi pi-exclamation-circle mr-1"></i>Las contraseñas no coinciden
            </small>
          </div>

          <!-- Botones -->
          <div class="flex gap-2 mt-5">
            <p-button
              type="button"
              label="Cancelar"
              icon="pi pi-times"
              severity="secondary"
              [outlined]="true"
              styleClass="w-full"
              (onClick)="cancel()"
              [disabled]="loading">
            </p-button>
            <p-button
              type="submit"
              label="Cambiar Contraseña"
              icon="pi pi-check"
              styleClass="w-full"
              [loading]="loading"
              [disabled]="loading">
            </p-button>
          </div>
        </form>

        <ng-template pTemplate="footer">
          <div class="text-center text-600 text-sm">
            <i class="pi pi-info-circle mr-1"></i>
            Tu contraseña debe tener al menos 6 caracteres
          </div>
        </ng-template>
      </p-card>
    </div>
  </div>
</div>
